<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Basic Page Info -->
    <meta charset="utf-8">
    <title>Limpio - Coming Soon</title>
    <meta name="description" content="Laaris - Coming Soon">
    <meta name="author" content="laaris.com">

    <!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="resources/img/fav.png"/>

    <!-- FONT -->
    <link href="https://fonts.googleapis.com/css?family=Lato:100,400,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Cormorant+Garamond:700|Lobster+Two" rel="stylesheet">

    <!-- ICON FONTS -->
    <link rel="stylesheet" href="css/font_awesome.css">

    <!-- CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.css" rel="stylesheet">
</head>
<body>

<div class="wrapper">
    <div id="stripes">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div id="particles-js"></div>

    <div class="home svg">

        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="#">
                <i class="fa fa-home" aria-hidden="true"></i>
            </a>
        </nav>

        <div class="container">
            <div class="row justify-content-center">
                <div class="col-6 text-center">
                    <span class="tools">Historial Pedidios <i class="fa fa-file-text-o" aria-hidden="true"></i></span>
                </div>
            </div>

            <br><br><br>

            <div class="row">

                <div class="col-12">
                    <div style="background-color: white">

                        <table id="table"
                               data-pagination="true"
                               data-data-field="items"
                               data-checkbox-header="true"
                               data-click-to-select="true"
                               data-filter-control="true"
                               data-page-size="5"

                               data-unique-id="NumeroPedido"
                        >
                            <thead>
                            <tr>
                                <th data-radio="true"></th>
                                <th data-field="NumeroPedido" data-filter-control="input">NumeroPedido </th>
                                <th data-field="Fentrada"data-filter-control="input" >Fentrada</th>
                                <th data-field="Cliente"data-filter-control="input" >Cliente</th>
                                <th data-field="Express"data-filter-control="input"  data-formatter="operateFormatterExpress" data-events="operateEventsExpress" data-align="center" >Express</th>
                                <th data-field="Fentrega"data-filter-control="input" >Fentrega</th>
                                <th data-field="Puntos"data-filter-control="input" >Puntos</th>
                                <th data-field="Estado"data-filter-control="input" >Estado</th>
                                <th data-field="EnvioAvsios" data-filter-control="input" data-formatter="operateFormatter" data-events="operateEvents" data-align="center">Descripcion</th>
                            </tr>
                            </thead>
                        </table>

                    </div>
                </div>

            </div>


            <div class="row justify-content-center" style="text-align: center; margin-top: 20px">
                <div class="col-12">
                    <button class="btn btn-default btn-cdi-action"> <i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Volver </button>
                    <button id="modalbuttonprod" class="btn btn-default btn-cdi-action" data-toggle="modal" data-target="#exampleModalCenter" disabled><i class="fa fa-trash" aria-hidden="true" ></i> Eliminar </button>
                    <button id="ObtenerDatos" class="btn btn-default btn-cdi-action" data-toggle="modal" data-target="#exampleModalCenter3"aria-hidden="true" disabled>  <i class="fa fa-floppy-o"  ></i>  Cambiar Estado</button>
                </div>
            </div>

        </div>
    </div>

</div>
<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title cancelar" id="exampleModalLongTitle"> <i class="fa fa-user-times" aria-hidden="true"></i> Eliminar Historial</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                ¿Está seguro que desea eliminar los historiales seleccionados?
            </div>
            <div class="modal-footer">



                <button class="btn btn-default btn-cdi-action cancelar" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i> Cancelar </button>
                <button id="remove"  class="btn btn-default btn-cdi-action aceptarOK">  <i class="fa fa-check" aria-hidden="true"></i> Aceptar</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="exampleModalCenter3" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle3" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" >
            <div class="modal-header" >
                <h2 class="modal-title aceptarOK " id="exampleModalLongTitle2"> <i class=" fa fa-archive" aria-hidden="true"></i> Cambiar estado de la prenda</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="exampleInputPassword1"><strong>Nuevo Estado</strong></label>
                        <input type="text" class="form-control" id="ValEstado" placeholder="Estado">
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-default btn-cdi-action cancelar" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i> Cancelar </button>
                <button class="btn btn-default btn-cdi-action aceptarOK" data-toggle="modal" data-target="#exampleModalCenter2"aria-hidden="true">  <i class="fa fa-check" aria-hidden="true"></i> Guardar</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="exampleModalCenter2" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle2" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="text-align: center !important;">
            <div class="modal-header" >
                <h2 class="modal-title aceptarOK " id="exampleModalLongTitle2"> <i class=" fa fa-archive" aria-hidden="true"></i> Cambiar estado de la prenda</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="text-align: center !important;">
                Los datos del estado se han guardado correctamente
            </div>
            <div class="modal-footer">
                <button id="saveProducto"  class="btn btn-default btn-cdi-action aceptarOK" data-dismiss="modal">  <i class="fa fa-check" aria-hidden="true"></i> Aceptar</button>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script type="text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/validator.js"></script>
<script type="text/javascript" src="js/particles.min.js"></script>
<script type="text/javascript" src="js/particles_2.js"></script>
<script type="text/javascript" src="js/script.js"></script>

<script src="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.js"></script>
<script src="https://unpkg.com/bootstrap-table@1.16.0/dist/extensions/toolbar/bootstrap-table-toolbar.min.js"></script>
<script src="https://unpkg.com/bootstrap-table@1.16.0/dist/extensions/filter-control/bootstrap-table-filter-control.min.js"></script>


<script type="text/javascript" src="js/utils.js"></script>
<script type="text/javascript" src="js/dbaccesso.js"></script>


<script>
    var $table = $('#table');
    var $modalbuttonprod = $('#modalbuttonprod');
    var $varObtenerDatos = $('#ObtenerDatos');
    $(function() {
        let data = obtenerdatos("HistorialPedidos");
        console.log(data);
        $table.bootstrapTable({data: data})
    })


    window.operateEvents = {
        'click .like': function (e, value, row) {
            alert('ENVIAR ' + value)
        },
    }

    function operateFormatter(value, row, index) {
        if (value === "si") {
            return [
                '<span class="aceptarOK"><i class="fa fa-check" aria-hidden="true"></i></span>'

            ].join('')
        }
        else {
            return [
                '<span class="cancelar"><i class="fa fa-times" aria-hidden="true"></i></span>'
            ].join('')
        }
    }

    window.operateEventsExpress = {
        'click .like': function (e, value, row) {
            alert('ENVIAR ' + value)
        },
    }

    function operateFormatterExpress(value, row, index) {
        if (value === "si") {
            return [
                '<span class="boltcolor"><i class="fa fa-bolt" aria-hidden="true"></i></span>'

            ].join('')
        }
        else {
            return [
                ' '
            ].join('')
        }
    }

    var $remove = $('#remove')

    $(function() {
        $table.on('check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table', function () {
            $remove.prop('disabled', !$table.bootstrapTable('getSelections').length)
            $modalbuttonprod.prop('disabled', !$table.bootstrapTable('getSelections').length)
            $varObtenerDatos.prop('disabled', !$table.bootstrapTable('getSelections').length)
        });

        $remove.click(function () {
            var ids = $.map($table.bootstrapTable('getSelections'), function (row) {
                return row.NumeroPedido;
            });

            $table.bootstrapTable('remove', {
                field: 'NumeroPedido',
                values: ids
            })
            $('#exampleModalCenter').modal('hide');
            $remove.prop('disabled', true)
            $modalbuttonprod.prop('disabled', true)
            $varObtenerDatos.prop('disabled', true)
        })
    })


    var $button = $('#ObtenerDatos')
    var $button2 = $('#saveProducto')
    $(function() {
        $button.click(function () {



            $(function() {
                $button2.click(function () {
                    var CambiarEstado = $table.bootstrapTable('getAllSelections');
                    $table.bootstrapTable('updateCell', {
                        index: CambiarEstado[0].NumeroPedido,


                        field: 'Estado',
                        value: $("#ValEstado").val()

                    });

                })
            })


        })
    })
</script>

</body>
</html>
